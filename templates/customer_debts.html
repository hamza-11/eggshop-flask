{% extends 'base.html' %}
{% block content %}
<div class="card card-modern p-3">
  <h4>سجل الديون لـ {{ customer.name }}</h4>
  <div class="alert alert-info">
    إجمالي الديون غير المسددة: <strong>{{ "%.2f"|format(total_debt) }}</strong>
  </div>
  
  <table class="table">
    <thead>
      <tr>
        <th>التاريخ</th>
        <th>رقم الفاتورة</th>
        <th>الإجمالي</th>
        <th>المدفوع</th>
        <th>المتبقي</th>
        <th>ملاحظات</th>
        <th>عمليات</th>
      </tr>
    </thead>
    <tbody>
      {% for sale in sales_in_debt %}
      <tr>
        <td>{{ sale.date.strftime('%Y-%m-%d') }}</td>
        <td><a href="{{ url_for('invoice', sale_id=sale.id) }}">{{ sale.id }}</a></td>
        <td>{{ "%.2f"|format(sale.total) }}</td>
        <td>{{ "%.2f"|format(sale.paid_amount) }}</td>
        <td><span class="badge bg-danger">{{ "%.2f"|format(sale.due_amount) }}</span></td>
        <td>{{ sale.notes }}</td>
        <td>
          <button class="btn btn-sm btn-success" disabled>تسديد</button>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="7" class="text-center">لا توجد ديون حالية لهذا الزبون.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  
  <div class="mt-3">
    <a href="{{ url_for('customers') }}" class="btn btn-secondary">العودة للقائمة</a>
  </div>
</div>
{% endblock %}